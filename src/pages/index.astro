---
import BaseLayout from '../layouts/BaseLayout.astro';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';

const baseUrl = import.meta.env.BASE_URL;
---

<BaseLayout title="SpecViT: Vision Transformers for Stellar Parameters">
  <Nav />

  <!-- ===== SECTION 1: HERO ===== -->
  <section class="hero-section">
    <div id="hero-particles" class="hero-particles"></div>
    <div class="hero-content text-center">
      <h1 class="animate-in" data-i18n-en="SpecViT" data-i18n-zh="SpecViT">SpecViT</h1>
      <p class="hero-subtitle animate-in delay-1"
         data-i18n-en="Vision Transformers for Stellar Parameter Estimation"
         data-i18n-zh="åŸºäºŽè§†è§‰Transformerçš„æ’æ˜Ÿå‚æ•°ä¼°è®¡">
        Vision Transformers for Stellar Parameter Estimation
      </p>
      <p class="hero-tagline animate-in delay-2"
         data-i18n-en="Learning to read stellar spectra through self-attention"
         data-i18n-zh="é€šè¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶å­¦ä¹ è§£è¯»æ’æ˜Ÿå…‰è°±">
        Learning to read stellar spectra through self-attention
      </p>

      <div class="hero-badges animate-in delay-3">
        <div class="glass-card metric-badge">
          <div class="metric-value" style="color:var(--accent-purple);">0.711</div>
          <div class="metric-label"
               data-i18n-en="RÂ² on DESI (50k)"
               data-i18n-zh="DESIæ•°æ®RÂ² (50k)">RÂ² on DESI (50k)</div>
        </div>
        <div class="glass-card metric-badge">
          <div class="metric-value" style="color:var(--accent-cyan);">0.196</div>
          <div class="metric-label"
               data-i18n-en="MAE (dex)"
               data-i18n-zh="MAE (dex)">MAE (dex)</div>
        </div>
        <div class="glass-card metric-badge">
          <div class="metric-value" style="color:var(--accent-green);">0.098</div>
          <div class="metric-label"
               data-i18n-en="Ïƒ on APOGEE"
               data-i18n-zh="APOGEEæ•£å·®Ïƒ">Ïƒ on APOGEE</div>
        </div>
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- ===== SECTION 2: KEY FINDINGS ===== -->
  <section id="findings" class="section-wide section-wash-lavender" style="padding-top:4rem; padding-bottom:4rem;">
    <h2 class="text-center" data-i18n-en="Key Findings" data-i18n-zh="æ ¸å¿ƒå‘çŽ°">Key Findings</h2>
    <div class="grid-3" style="margin-top:2rem;">

      <div class="glass-card">
        <div class="icon-box">ðŸŽ¯</div>
        <h3 data-i18n-en="Near-Optimal at Low SNR" data-i18n-zh="ä½Žä¿¡å™ªæ¯”ä¸‹æŽ¥è¿‘æœ€ä¼˜">Near-Optimal at Low SNR</h3>
        <p data-i18n-en="SpecViT comes within 0.02 RÂ² of the Fisher Information / CRLB theoretical ceiling at SNR â‰ˆ 4.6. The model extracts nearly all the information that is physically present in the data."
           data-i18n-zh="åœ¨SNR â‰ˆ 4.6æ—¶ï¼ŒSpecViTçš„RÂ²ä»…æ¯”Fisherä¿¡æ¯/CRLBç†è®ºä¸Šé™ä½Ž0.02ã€‚è¯¥æ¨¡åž‹å‡ ä¹Žæå–äº†æ•°æ®ä¸­æ‰€æœ‰å¯ç”¨çš„ç‰©ç†ä¿¡æ¯ã€‚">
          SpecViT comes within 0.02 RÂ² of the Fisher Information / CRLB theoretical ceiling at SNR â‰ˆ 4.6. The model extracts nearly all the information that is physically present in the data.
        </p>
      </div>

      <div class="glass-card">
        <div class="icon-box">âœ¨</div>
        <h3 data-i18n-en="Clean Priors > Big Data" data-i18n-zh="é«˜è´¨é‡å…ˆéªŒ > å¤§æ•°æ®é‡">Clean Priors > Big Data</h3>
        <p data-i18n-en="BOSZ-only training achieves Ïƒ = 0.098 on APOGEE, beating DESI-360k training (Ïƒ = 0.175) by 78%. Clean synthetic spectra provide more useful physical priors than massive noisy catalogs."
           data-i18n-zh="ä»…ä½¿ç”¨BOSZåˆæˆæ•°æ®è®­ç»ƒåœ¨APOGEEä¸Šè¾¾åˆ°Ïƒ = 0.098ï¼Œæ¯”ä½¿ç”¨DESI-360kè®­ç»ƒ(Ïƒ = 0.175)ä¼˜78%ã€‚é«˜è´¨é‡åˆæˆå…‰è°±æä¾›äº†æ¯”å¤§é‡å™ªå£°æ•°æ®æ›´æœ‰æ•ˆçš„ç‰©ç†å…ˆéªŒã€‚">
          BOSZ-only training achieves Ïƒ = 0.098 on APOGEE, beating DESI-360k training (Ïƒ = 0.175) by 78%. Clean synthetic spectra provide more useful physical priors than massive noisy catalogs.
        </p>
      </div>

      <div class="glass-card">
        <div class="icon-box">ðŸ”„</div>
        <h3 data-i18n-en="Cross-Survey Transfer" data-i18n-zh="è·¨å·¡å¤©è¿ç§»">Cross-Survey Transfer</h3>
        <p data-i18n-en="A single SpecViT model works across optical (DESI, 710â€“885 nm) and near-infrared (APOGEE, 1.5â€“1.7 Î¼m) surveys. One architecture, multiple instruments."
           data-i18n-zh="å•ä¸€SpecViTæ¨¡åž‹å¯åŒæ—¶å¤„ç†å…‰å­¦(DESI, 710â€“885 nm)å’Œè¿‘çº¢å¤–(APOGEE, 1.5â€“1.7 Î¼m)å·¡å¤©æ•°æ®ã€‚ä¸€ç§æž¶æž„ï¼Œå¤šç§ä»ªå™¨ã€‚">
          A single SpecViT model works across optical (DESI, 710â€“885 nm) and near-infrared (APOGEE, 1.5â€“1.7 Î¼m) surveys. One architecture, multiple instruments.
        </p>
      </div>

    </div>
  </section>

  <div class="section-divider"></div>

  <!-- ===== SECTION 3: THE CHALLENGE ===== -->
  <section id="challenge" class="section">
    <h2 data-i18n-en="The Challenge" data-i18n-zh="æŒ‘æˆ˜">The Challenge</h2>
    <p data-i18n-en="Every star's light encodes its physical properties â€” gravity, temperature, composition. But extracting a single parameter (like surface gravity log g) from a noisy 4096-pixel spectrum is non-trivial, especially for faint targets at magnitude >20."
       data-i18n-zh="æ¯é¢—æ’æ˜Ÿçš„å…‰è°±éƒ½ç¼–ç äº†å…¶ç‰©ç†å±žæ€§â€”â€”é‡åŠ›ã€æ¸©åº¦ã€åŒ–å­¦æˆåˆ†ã€‚ä½†ä»Žä¸€ä¸ªåŒ…å«4096åƒç´ çš„å™ªå£°å…‰è°±ä¸­æå–å•ä¸€å‚æ•°ï¼ˆå¦‚è¡¨é¢é‡åŠ›log gï¼‰å¹¶éžæ˜“äº‹ï¼Œå°¤å…¶æ˜¯å¯¹äºŽæ˜Ÿç­‰>20çš„æš—å¼±ç›®æ ‡ã€‚">
      Every star's light encodes its physical properties â€” gravity, temperature, composition. But extracting a single parameter (like surface gravity log g) from a noisy 4096-pixel spectrum is non-trivial, especially for faint targets at magnitude >20.
    </p>

    <div class="callout callout-insight">
      <strong data-i18n-en="Key Insight:" data-i18n-zh="å…³é”®æ´žå¯Ÿï¼š">Key Insight:</strong>
      <span data-i18n-en="Not all wavelengths matter equally. Attention mechanisms can learn which spectral features are physically informative â€” the calcium triplet, magnesium lines, and iron features that carry the strongest gravity signal."
            data-i18n-zh="å¹¶éžæ‰€æœ‰æ³¢é•¿éƒ½åŒç­‰é‡è¦ã€‚æ³¨æ„åŠ›æœºåˆ¶å¯ä»¥å­¦ä¹ å“ªäº›å…‰è°±ç‰¹å¾å…·æœ‰ç‰©ç†ä¿¡æ¯ä»·å€¼â€”â€”é’™ä¸‰é‡çº¿ã€é•çº¿å’Œé“çº¿æºå¸¦äº†æœ€å¼ºçš„é‡åŠ›ä¿¡å·ã€‚">
        Not all wavelengths matter equally. Attention mechanisms can learn which spectral features are physically informative â€” the calcium triplet, magnesium lines, and iron features that carry the strongest gravity signal.
      </span>
    </div>

    <h3 style="margin-top:2rem;"
        data-i18n-en="Interactive: SNR Degradation Explorer"
        data-i18n-zh="äº¤äº’æ¼”ç¤ºï¼šä¿¡å™ªæ¯”è¡°å‡æŽ¢ç´¢å™¨">Interactive: SNR Degradation Explorer</h3>
    <p class="text-muted" style="font-size:0.9rem;"
       data-i18n-en="Drag the slider to see how the same stellar spectrum degrades as the star gets fainter."
       data-i18n-zh="æ‹–åŠ¨æ»‘å—æŸ¥çœ‹åŒä¸€æ’æ˜Ÿå…‰è°±éšç€æ’æ˜Ÿå˜æš—æ—¶çš„é€€åŒ–æƒ…å†µã€‚">
      Drag the slider to see how the same stellar spectrum degrades as the star gets fainter.
    </p>
    <div class="demo-container" style="margin-top:1rem;">
      <div id="snr-explorer"></div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- ===== SECTION 4: METHOD ===== -->
  <section id="method" class="section-wide section-wash-mint">
    <h2 data-i18n-en="Method: Architecture Walkthrough" data-i18n-zh="æ–¹æ³•ï¼šæž¶æž„è¯¦è§£">Method: Architecture Walkthrough</h2>
    <p data-i18n-en="SpecViT applies Vision Transformer architecture to 1D stellar spectra:"
       data-i18n-zh="SpecViTå°†è§†è§‰Transformeræž¶æž„åº”ç”¨äºŽä¸€ç»´æ’æ˜Ÿå…‰è°±ï¼š">
      SpecViT applies Vision Transformer architecture to 1D stellar spectra:
    </p>

    <!-- Pipeline diagram -->
    <div class="pipeline" style="margin:2rem 0; justify-content:center;">
      <span class="pipeline-step" data-i18n-en="Spectrum (4096 px)" data-i18n-zh="å…‰è°± (4096åƒç´ )">Spectrum (4096 px)</span>
      <span class="pipeline-arrow">â†’</span>
      <span class="pipeline-step" data-i18n-en="256 Patches" data-i18n-zh="256ä¸ªPatch">256 Patches</span>
      <span class="pipeline-arrow">â†’</span>
      <span class="pipeline-step" data-i18n-en="Token Embed" data-i18n-zh="TokenåµŒå…¥">Token Embed</span>
      <span class="pipeline-arrow">â†’</span>
      <span class="pipeline-step" data-i18n-en="6-Layer ViT" data-i18n-zh="6å±‚ViT">6-Layer ViT</span>
      <span class="pipeline-arrow">â†’</span>
      <span class="pipeline-step" data-i18n-en="log g" data-i18n-zh="log g">log g</span>
    </div>

    <!-- Static architecture image -->
    <div class="text-center" style="margin:1.5rem 0;">
      <img src={`${baseUrl}/figures/specvit_pipeline.jpg`} alt="SpecViT Architecture"
           style="max-width:100%; border-radius:12px; box-shadow:0 4px 20px rgba(140,120,200,0.1);" />
    </div>

    <h3 style="margin-top:2.5rem;"
        data-i18n-en="Interactive: Tokenization Visualizer"
        data-i18n-zh="äº¤äº’æ¼”ç¤ºï¼šTokenåŒ–å¯è§†åŒ–">Interactive: Tokenization Visualizer</h3>
    <p class="text-muted" style="font-size:0.9rem;"
       data-i18n-en="Hover over patches to see how the spectrum is divided. Patch colors show attention weight â€” brighter means higher attention."
       data-i18n-zh="å°†é¼ æ ‡æ‚¬åœåœ¨patchä¸ŠæŸ¥çœ‹å…‰è°±å¦‚ä½•è¢«åˆ†å‰²ã€‚Patché¢œè‰²è¡¨ç¤ºæ³¨æ„åŠ›æƒé‡â€”â€”è¶Šäº®è¡¨ç¤ºæ³¨æ„åŠ›è¶Šé«˜ã€‚">
      Hover over patches to see how the spectrum is divided. Patch colors show attention weight â€” brighter means higher attention.
    </p>
    <div class="demo-container" style="margin-top:1rem;">
      <div id="tokenization-viz"></div>
    </div>

    <!-- Key equations -->
    <div style="margin-top:2.5rem;">
      <h3 data-i18n-en="Key Equations" data-i18n-zh="æ ¸å¿ƒå…¬å¼">Key Equations</h3>

      <div class="math-block">
        <p style="margin-bottom:0.5rem; color:var(--text-secondary); font-size:0.9rem;"
           data-i18n-en="Patch embedding:" data-i18n-zh="PatchåµŒå…¥ï¼š">Patch embedding:</p>
        <div id="eq-patch"></div>
      </div>

      <div class="math-block">
        <p style="margin-bottom:0.5rem; color:var(--text-secondary); font-size:0.9rem;"
           data-i18n-en="Self-attention:" data-i18n-zh="è‡ªæ³¨æ„åŠ›ï¼š">Self-attention:</p>
        <div id="eq-attention"></div>
      </div>

      <div class="math-block">
        <p style="margin-bottom:0.5rem; color:var(--text-secondary); font-size:0.9rem;"
           data-i18n-en="Training loss (Huber):" data-i18n-zh="è®­ç»ƒæŸå¤±ï¼ˆHuberï¼‰ï¼š">Training loss (Huber):</p>
        <div id="eq-loss"></div>
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- ===== SECTION 5: ATTENTION EXPLORER ===== -->
  <section id="attention" class="section-wide">
    <h2 data-i18n-en="Attention Map Explorer" data-i18n-zh="æ³¨æ„åŠ›å›¾æŽ¢ç´¢å™¨">Attention Map Explorer</h2>
    <p data-i18n-en="Explore what the model learns to attend to. The deepest layers concentrate attention on the Ca II infrared triplet (Î»8498, 8542, 8662 Ã…) â€” the strongest surface gravity indicator in this wavelength range."
       data-i18n-zh="æŽ¢ç´¢æ¨¡åž‹å­¦ä¼šå…³æ³¨çš„å†…å®¹ã€‚æœ€æ·±å±‚çš„æ³¨æ„åŠ›é›†ä¸­åœ¨Ca IIçº¢å¤–ä¸‰é‡çº¿(Î»8498, 8542, 8662 Ã…)ä¸Šâ€”â€”è¿™æ˜¯è¯¥æ³¢é•¿èŒƒå›´å†…æœ€å¼ºçš„è¡¨é¢é‡åŠ›æŒ‡æ ‡ã€‚">
      Explore what the model learns to attend to. The deepest layers concentrate attention on the Ca II infrared triplet (Î»8498, 8542, 8662 Ã…) â€” the strongest surface gravity indicator in this wavelength range.
    </p>
    <div class="demo-container" style="margin-top:1.5rem;">
      <div id="attention-explorer"></div>
    </div>
    <!-- Static fallback -->
    <details style="margin-top:1rem;">
      <summary data-i18n-en="Static attention map (fallback)" data-i18n-zh="é™æ€æ³¨æ„åŠ›å›¾ï¼ˆå¤‡é€‰ï¼‰">Static attention map (fallback)</summary>
      <img src={`${baseUrl}/figures/attention_map_averaged.png`} alt="Attention Map Averaged"
           style="max-width:100%; border-radius:8px; margin-top:1rem;" />
    </details>
  </section>

  <div class="section-divider"></div>

  <!-- ===== SECTION 6: RESULTS DASHBOARD ===== -->
  <section id="results" class="section-wide section-wash-rose">
    <h2 data-i18n-en="Results Dashboard" data-i18n-zh="ç»“æžœä»ªè¡¨ç›˜">Results Dashboard</h2>
    <p data-i18n-en="Explore SpecViT's performance across multiple axes. Click tabs to switch views."
       data-i18n-zh="ä»Žå¤šä¸ªç»´åº¦æŽ¢ç´¢SpecViTçš„æ€§èƒ½ã€‚ç‚¹å‡»æ ‡ç­¾é¡µåˆ‡æ¢è§†å›¾ã€‚">
      Explore SpecViT's performance across multiple axes. Click tabs to switch views.
    </p>
    <div class="demo-container" style="margin-top:1.5rem;">
      <div id="results-dashboard"></div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- ===== SECTION 7: TRANSFER LEARNING ===== -->
  <section id="transfer" class="section-wide">
    <h2 data-i18n-en="Transfer Learning Story" data-i18n-zh="è¿ç§»å­¦ä¹ åŽ†ç¨‹">Transfer Learning Story</h2>
    <p data-i18n-en="How do synthetic spectra inform real-world prediction? We compare three strategies:"
       data-i18n-zh="åˆæˆå…‰è°±å¦‚ä½•æŒ‡å¯¼çœŸå®žä¸–ç•Œçš„é¢„æµ‹ï¼Ÿæˆ‘ä»¬æ¯”è¾ƒäº†ä¸‰ç§ç­–ç•¥ï¼š">
      How do synthetic spectra inform real-world prediction? We compare three strategies:
    </p>

    <!-- Visual pipeline -->
    <div class="pipeline" style="margin:2rem 0; justify-content:center;">
      <span class="pipeline-step" style="background:rgba(124,92,191,0.15); border-color:var(--accent-purple);"
            data-i18n-en="BOSZ Synthetic" data-i18n-zh="BOSZåˆæˆæ•°æ®">BOSZ Synthetic</span>
      <span class="pipeline-arrow">â†’</span>
      <span class="pipeline-step" style="background:rgba(45,165,184,0.15); border-color:var(--accent-cyan);"
            data-i18n-en="DESI Real" data-i18n-zh="DESIçœŸå®žæ•°æ®">DESI Real</span>
      <span class="pipeline-arrow">â†’</span>
      <span class="pipeline-step" style="background:rgba(61,168,122,0.15); border-color:var(--accent-green);"
            data-i18n-en="APOGEE Test" data-i18n-zh="APOGEEæµ‹è¯•">APOGEE Test</span>
    </div>

    <!-- Comparison table -->
    <div class="demo-container" style="overflow-x:auto;">
      <table class="comparison-table">
        <thead>
          <tr>
            <th data-i18n-en="Strategy" data-i18n-zh="ç­–ç•¥">Strategy</th>
            <th data-i18n-en="Training Data" data-i18n-zh="è®­ç»ƒæ•°æ®">Training Data</th>
            <th>Ïƒ (dex)</th>
            <th>RÂ²</th>
            <th>MAE</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="highlight" data-i18n-en="BOSZ-only (Clean Prior)" data-i18n-zh="ä»…BOSZï¼ˆé«˜è´¨é‡å…ˆéªŒï¼‰">BOSZ-only (Clean Prior)</td>
            <td>50k BOSZ</td>
            <td class="highlight">0.098</td>
            <td class="highlight">0.956</td>
            <td class="highlight">0.071</td>
          </tr>
          <tr>
            <td data-i18n-en="DESI Direct" data-i18n-zh="ç›´æŽ¥DESI">DESI Direct</td>
            <td>360k DESI</td>
            <td>0.175</td>
            <td>0.889</td>
            <td>0.128</td>
          </tr>
          <tr>
            <td data-i18n-en="Two-Stage" data-i18n-zh="ä¸¤é˜¶æ®µ">Two-Stage</td>
            <td>BOSZ + DESI</td>
            <td>0.112</td>
            <td>0.942</td>
            <td>0.082</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="callout callout-success" style="margin-top:1.5rem;">
      <strong data-i18n-en="Key Insight:" data-i18n-zh="å…³é”®æ´žå¯Ÿï¼š">Key Insight:</strong>
      <span data-i18n-en="More data â‰  better. Clean synthetic priors (50k BOSZ) outperform massive noisy catalogs (360k DESI) by 78% in prediction scatter. Quality of physics modeling trumps quantity of observations."
            data-i18n-zh="æ›´å¤šæ•°æ® â‰  æ›´å¥½ã€‚é«˜è´¨é‡åˆæˆå…ˆéªŒï¼ˆ50k BOSZï¼‰åœ¨é¢„æµ‹æ•£å·®ä¸Šæ¯”å¤§é‡å™ªå£°ç›®å½•ï¼ˆ360k DESIï¼‰ä¼˜78%ã€‚ç‰©ç†å»ºæ¨¡çš„è´¨é‡èƒœè¿‡è§‚æµ‹æ•°æ®çš„æ•°é‡ã€‚">
        More data â‰  better. Clean synthetic priors (50k BOSZ) outperform massive noisy catalogs (360k DESI) by 78% in prediction scatter. Quality of physics modeling trumps quantity of observations.
      </span>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- ===== SECTION 8: SPECTRUM EXPLORER ===== -->
  <section id="explore" class="section-wide section-wash-mint">
    <h2 data-i18n-en="Spectrum Explorer" data-i18n-zh="å…‰è°±æŽ¢ç´¢å™¨">Spectrum Explorer</h2>
    <p data-i18n-en="Browse 7 example DESI spectra spanning giants, subgiants, and dwarfs. Drag to pan, scroll to zoom."
       data-i18n-zh="æµè§ˆ7æ¡ç¤ºä¾‹DESIå…‰è°±ï¼Œæ¶µç›–å·¨æ˜Ÿã€äºšå·¨æ˜Ÿå’ŒçŸ®æ˜Ÿã€‚æ‹–åŠ¨å¹³ç§»ï¼Œæ»šè½®ç¼©æ”¾ã€‚">
      Browse 7 example DESI spectra spanning giants, subgiants, and dwarfs. Drag to pan, scroll to zoom.
    </p>
    <div class="demo-container" style="margin-top:1.5rem;">
      <div id="spectrum-explorer"></div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- ===== SECTION 9: DEEP DIVE ===== -->
  <section id="paper" class="section">
    <h2 data-i18n-en="Deep Dive" data-i18n-zh="æ·±å…¥äº†è§£">Deep Dive</h2>

    <details>
      <summary data-i18n-en="Fisher Information & CRLB" data-i18n-zh="Fisherä¿¡æ¯ä¸ŽCRLB">Fisher Information & CRLB</summary>
      <div style="margin-top:1rem;">
        <p data-i18n-en="The CramÃ©r-Rao Lower Bound (CRLB) defines the minimum achievable variance for any unbiased estimator. For a parameter Î¸ estimated from data x with likelihood p(x|Î¸):"
           data-i18n-zh="CramÃ©r-Raoä¸‹ç•Œ(CRLB)å®šä¹‰äº†ä»»ä½•æ— åä¼°è®¡å™¨å¯è¾¾åˆ°çš„æœ€å°æ–¹å·®ã€‚å¯¹äºŽä»Žæ•°æ®xä¼°è®¡å‚æ•°Î¸ï¼Œä¼¼ç„¶å‡½æ•°p(x|Î¸)ï¼š">
          The CramÃ©r-Rao Lower Bound (CRLB) defines the minimum achievable variance for any unbiased estimator. For a parameter Î¸ estimated from data x with likelihood p(x|Î¸):
        </p>
        <div class="math-block">
          <div id="eq-crlb"></div>
        </div>
        <p data-i18n-en="We compute Fisher information from BOSZ synthetic spectra, where the noise model is known exactly. This gives us a theoretical performance ceiling against which we benchmark SpecViT."
           data-i18n-zh="æˆ‘ä»¬ä»ŽBOSZåˆæˆå…‰è°±è®¡ç®—Fisherä¿¡æ¯ï¼Œå› ä¸ºå™ªå£°æ¨¡åž‹æ˜¯ç²¾ç¡®å·²çŸ¥çš„ã€‚è¿™ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç†è®ºæ€§èƒ½ä¸Šé™ï¼Œä½œä¸ºSpecViTçš„åŸºå‡†ã€‚">
          We compute Fisher information from BOSZ synthetic spectra, where the noise model is known exactly. This gives us a theoretical performance ceiling against which we benchmark SpecViT.
        </p>
      </div>
    </details>

    <details>
      <summary data-i18n-en="Training Procedure" data-i18n-zh="è®­ç»ƒæµç¨‹">Training Procedure</summary>
      <div style="margin-top:1rem;">
        <p data-i18n-en="SpecViT-S (Small) configuration:" data-i18n-zh="SpecViT-Sï¼ˆå°åž‹ï¼‰é…ç½®ï¼š">SpecViT-S (Small) configuration:</p>
        <ul style="color:var(--text-secondary); margin:0.5rem 0 1rem 1.5rem; line-height:2;">
          <li>6 Transformer layers, 6 attention heads, embed_dim = 384</li>
          <li>Patch size = 16, num_patches = 256</li>
          <li>AdamW optimizer, lr = 3e-4, cosine annealing</li>
          <li>Huber loss (Î´ = 0.5), batch size = 256</li>
          <li>Training: ~50 epochs on 1Ã— A100 GPU (~30 min)</li>
        </ul>
      </div>
    </details>

    <details>
      <summary data-i18n-en="Computational Cost" data-i18n-zh="è®¡ç®—æˆæœ¬">Computational Cost</summary>
      <div style="margin-top:1rem;">
        <table class="comparison-table">
          <thead>
            <tr>
              <th data-i18n-en="Model" data-i18n-zh="æ¨¡åž‹">Model</th>
              <th data-i18n-en="Params" data-i18n-zh="å‚æ•°é‡">Params</th>
              <th data-i18n-en="Train Time" data-i18n-zh="è®­ç»ƒæ—¶é—´">Train Time</th>
              <th data-i18n-en="Inference" data-i18n-zh="æŽ¨ç†">Inference</th>
              <th>RÂ²</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Ridge Regression</td>
              <td>4K</td>
              <td>&lt;1 min</td>
              <td>&lt;1 ms</td>
              <td>0.507</td>
            </tr>
            <tr>
              <td>LightGBM</td>
              <td>~100K</td>
              <td>~2 min</td>
              <td>&lt;1 ms</td>
              <td>0.647</td>
            </tr>
            <tr>
              <td class="highlight">SpecViT-S</td>
              <td class="highlight">7.4M</td>
              <td>~30 min</td>
              <td>~2 ms</td>
              <td class="highlight">0.731</td>
            </tr>
          </tbody>
        </table>
      </div>
    </details>
  </section>

  <!-- ===== SECTION 10: FOOTER ===== -->
  <Footer />

  <!-- ===== ISLAND SCRIPTS ===== -->
  <script src="../islands/HeroParticles.ts"></script>
  <script src="../islands/SNRExplorer.ts"></script>
  <script src="../islands/TokenizationViz.ts"></script>
  <script src="../islands/AttentionExplorer.ts"></script>
  <script src="../islands/ResultsDashboard.ts"></script>
  <script src="../islands/SpectrumExplorer.ts"></script>
  <script src="../islands/StellarTypeChart.ts"></script>

  <!-- KaTeX rendering -->
  <script>
    import katex from 'katex';

    function renderEq(id: string, tex: string) {
      const el = document.getElementById(id);
      if (el) katex.render(tex, el, { displayMode: true, throwOnError: false });
    }

    renderEq('eq-patch', 'z_i = \\mathbf{E} \\cdot x_{[i \\cdot P : (i+1) \\cdot P]} + e_i^{\\text{pos}}, \\quad i = 0, \\ldots, N_p - 1');
    renderEq('eq-attention', '\\text{Attention}(Q,K,V) = \\text{softmax}\\left(\\frac{QK^\\top}{\\sqrt{d_k}}\\right) V');
    renderEq('eq-loss', '\\mathcal{L}_{\\delta}(y, \\hat{y}) = \\begin{cases} \\frac{1}{2}(y - \\hat{y})^2 & \\text{if } |y - \\hat{y}| \\le \\delta \\\\ \\delta|y - \\hat{y}| - \\frac{1}{2}\\delta^2 & \\text{otherwise} \\end{cases}');
    renderEq('eq-crlb', '\\text{Var}(\\hat{\\theta}) \\geq \\frac{1}{I(\\theta)}, \\quad I(\\theta) = -\\mathbb{E}\\left[\\frac{\\partial^2 \\ln p(x|\\theta)}{\\partial \\theta^2}\\right]');
  </script>
</BaseLayout>

<style>
  /* Hero section */
  .hero-section {
    position: relative;
    min-height: 85vh;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 60px;
    overflow: hidden;
  }

  .hero-particles {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .hero-content {
    position: relative;
    z-index: 1;
    max-width: 800px;
    padding: 2rem;
  }

  .hero-subtitle {
    font-size: clamp(1.2rem, 2.5vw, 1.6rem);
    color: var(--text-secondary);
    font-weight: 400;
    margin-bottom: 0.5rem;
    margin-top: -0.5rem;
  }

  .hero-tagline {
    font-size: 1.1rem;
    color: var(--text-muted);
    font-style: italic;
    margin-bottom: 3rem;
  }

  .hero-badges {
    display: flex;
    gap: 1.5rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .hero-badges .glass-card {
    min-width: 140px;
  }

  @media (max-width: 768px) {
    .hero-section {
      min-height: 70vh;
    }

    .hero-badges {
      gap: 1rem;
    }

    .hero-badges .glass-card {
      min-width: 100px;
      padding: 1rem;
    }

    .hero-badges .metric-value {
      font-size: 1.8rem;
    }
  }
</style>
